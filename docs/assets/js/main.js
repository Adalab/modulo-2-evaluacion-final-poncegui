"use strict";const input=document.querySelector(".js_inputUser"),btnSearch=document.querySelector(".js_btnSearch"),imageError="https://via.placeholder.com/100x75?text=Ups!+we+are+not+perfect",messageError=document.querySelector(".js-messageError"),listContainer=document.querySelector(".js_results"),listFavDom=document.querySelector(".js_favorites");let tvSerieslist=[],fav=[];function handleSearch(e){e.preventDefault();const t=input.value;listContainer.innerHTML="",fetch("https://api.jikan.moe/v3/search/anime?q="+t).then(e=>e.json()).then(t=>{tvSerieslist=t.results,null==tvSerieslist?(renderError(),input.value="",handleSearch(e)):renderAnimeTvShows()})}function renderError(){messageError.innerHTML="Sorry! not found. Let's try another movie"}function renderAnimeTvShows(){tvSerieslist.forEach(e=>{listContainer.innerHTML+=`<li class="js_results js-eachCard" data-id="${e.mal_id}"> <img class="movie_img" src="${e.image_url}" alt="anime show"  <h3 class="movie_title">${e.title}</h3> </li>`});document.querySelector(".js_btnReset").addEventListener("click",e=>{e.preventDefault,listContainer.innerHTML="",input.value="",messageError.innerHTML=""}),listenEachCard()}const listenEachCard=()=>{const e=document.querySelectorAll(".js-eachCard");for(const t of e)t.addEventListener("click",handleAddCardFav)},handleAddCardFav=e=>{const t=parseInt(e.currentTarget.dataset.id);e.target.parentElement.classList.add("js-colors");const a=tvSerieslist.find(e=>e.mal_id===t);void 0===fav.find(e=>e.mal_id===t)&&(fav.push(a),renderFav(),setLocalStorageFav()),console.log(fav)},renderFav=()=>{const e=document.createElement("li"),t=document.createElement("img"),a=document.createElement("btn");a.classList.add("js_favorites__childs"),Object.values(fav).forEach(r=>{e.textContent=r.title,t.src=r.image_url,t.alt=r.title,a.textContent="x",a.dataset.id=r.mal_id,listFavDom.appendChild(e),listFavDom.appendChild(t),listFavDom.appendChild(a)});document.querySelector(".js_resetFav").addEventListener("click",e=>{e.preventDefault,listFavDom.innerHTML="",fav.splice(0,fav.length),setLocalStorageFav()}),listenRemoveFav()},listenRemoveFav=()=>{if(fav.length>0){const e=document.querySelectorAll(".js_favorites__childs");for(const t of e)t.addEventListener("click",handleRemoveFavCard)}},handleRemoveFavCard=e=>{const t=parseInt(e.currentTarget.dataset.id);console.log(t);const a=fav.find(e=>e.mal_id===t);void 0!==a&&fav.pop(a),renderFav(),console.log(fav),setLocalStorageFav()},setLocalStorageFav=()=>{const e=JSON.stringify(fav);localStorage.setItem("fav",e),console.log(fav)},getLocalstorageFav=()=>{const e=localStorage.getItem("fav");null!==e&&(fav=JSON.parse(e),console.log(fav))};getLocalstorageFav(),btnSearch.addEventListener("click",handleSearch);